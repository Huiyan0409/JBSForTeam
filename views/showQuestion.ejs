<%- include('header') -%>
<%- include('navbar') -%>

<section class="section">
  <div class="section__content section__content--fixed-width">
    <div class="jumbotron masthead diagonal-gradient text-center">
      <div class="section__title section__title--centered" id="whiteFont">
        Question: <%= question.question %>
      </div>
      <!-- Author -->
      <div class="section__description section__description--centered" id="whiteFont">
        by
        <a href="/showProfile/<%=question.userId%>"><%=question.userName%></a>
        posted on <%= question.createdAt %>
      </div>
      <% if (loggedIn) { %>
        <% if (question.userId.equals(user._id)) { %>
          <a class="btn btn--blue-bg" href="/showQuestion/<%=question._id%>/editQuestion" role="button">Edit</a>
        <% } %>
      <% } %>
      <a class="btn btn--blue-bg" href="/showQuestions" role="button">Return to Question List</a>
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="row">
      <div class="col">
        <h5><b>Description: </b></h5>
        <hr>
        <!-- Post Content -->
        <p class="lead" id ="description"><%= question.description%></p>
        <hr>

        <h5><b>Comments: </b></h5>
        <hr>
        <% for(i = 0; i < answers.length; i++){  %>
          <!-- Single Comment in card-->
            <div class="media mb-3" id ="description">
              <a href="/showProfile/<%=answers[i].userId%>"><img class="d-flex mr-3 rounded-circle" id="profilePic" src="<%=answers[i].profilePicURL%>" width="40px" height="40px" alt="user profile pic"></a>
              <div class="media-body">
                <h5><%= answers[i].userName %></h5>
                <h6><%= answers[i].answer %></h6>
                <% if (loggedIn) {%>
                  <% if (answers[i].userId.equals(user._id)) { %>
                    <div class="container">
                      <div class="row">
                        <div class="col-1">
                          <form method="post" action="/showQuestion/<%=question._id%>/answerDelete">
                            <input type="hidden" name="delete" value="<%=answers[i]._id%>">
                            <input class="btn btn-sm btn-outline-danger" type="submit" value="delete">
                          </form>
                        </div>
                        <div class="col-1">
                          <form method="post" action="/showQuestion/<%=question._id%>/answerLikes">
                            <input type="hidden" name="likes" value="<%=answers[i]._id%>">
                            <button class="btn btn-sm btn-outline-dark"><i class="fa fa-thumbs-up fa-1x"></i> 1</button>
                          </form>
                        </div>
                      </div>
                    </div>
                  <% } %>
                <% } %>
              </div>
            </div>
          <% } %>
      </div>
    </div>
  </div>
</section>

<section class='section'>
  <div class="container">
    <div class="row">
      <div class="col">
        <!-- Comments Form -->
        <div class="card">
          <h5 class="card-header">Leave a Comment:</h5>
          <div class="card-body">
            <form action="/showQuestion/<%=req.params.id%>/processAnswerPost" method="post">
              <div class="form-group">
                <textarea class="form-control" name="answer" rows="3"></textarea>
              </div>
              <% if (loggedIn) {%>
                <button type="submit" class="btn btn-outline-primary">Submit</button>
              <% } else { %>
                Please login to submit.
              <% } %>
            </form>
          </div>
        </div>
      </div>
    </div>

  </div>

</section>


<%- include('footer') -%>
